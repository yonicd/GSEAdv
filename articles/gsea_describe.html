<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GSEAdv: Describe • GSEAdv</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GSEAdv: Describe">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GSEAdv</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gsea.html">About GSEAdv</a>
    </li>
    <li>
      <a href="../articles/gsea_describe.html">GSEAdv: Describe</a>
    </li>
    <li>
      <a href="../articles/gsea_evaluate.html">GSEAdv: Evaluate</a>
    </li>
    <li>
      <a href="../articles/gsea_simulate.html">GSEAdv: Simulate</a>
    </li>
    <li>
      <a href="../articles/tests_and_coverage.html">Tests and Coverage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/llrs/GSEAdv">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>GSEAdv: Describe</h1>
                        <h4 class="author">Lluís Revilla</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><a class="author_email" href="mailto:#"></a><a href="mailto:lrevilla@clinic.cat">lrevilla@clinic.cat</a>
      </address>
                  
            <h4 class="date">14 September 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/GSEAdv/blob/master/vignettes/gsea_describe.Rmd"><code>vignettes/gsea_describe.Rmd</code></a></small>
      <div class="hidden name"><code>gsea_describe.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Shows the methods and functions used to describe the relationship between genes and gene sets.
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette assumes that the reader is familiar with the infraestructure build in Bioconductor around gene sets, mainly <em><a href="http://bioconductor.org/packages/GSEABase">GSEABase</a></em>. It provides examples of how to use the package to find the relationships between genes and gene sets.</p>
<p>A <code>GeneSetCollection</code> is a collection of <code>GeneSet</code>s wchich can be totally unrelated or, as expected, related between them. All the over representative analysis (ORA), such as the hypergeometric test or chi-square test) assume that each gene is independent of other genes. This vignette shows how to check and describe the relationship between the genes and the gene sets to improve existing tools testing over-representation.</p>
</div>
<div id="preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h1>
<p>First let’s load a <code>GeneSetCollection</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"Broad.xml"</span>, <span class="dt">package =</span> <span class="st">"GSEABase"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">gss &lt;-<span class="st"> </span><span class="kw">getBroadSets</span>(fl)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">gss</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">## GeneSetCollection</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">##   names: chr5q23, chr16q24 (2 total)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">##   unique identifiers: ZNF474, CCDC100, ..., TRAPPC2L (215 total)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">##   types in collection:</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">##     geneIdType: SymbolIdentifier (1 total)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">##     collectionType: BroadCollection (1 total)</a></code></pre></div>
<p>We can see what the collection has but we don’t know what is the relationship between genes and gene sets. A first approach would be to use summary to find more information about that relationship:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/summary.html">summary</a></span>(gss)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">## Genes: 215</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">##  Gene in more pathways: 1 pathways</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">##  h-index: 0 genes with at least 0 pathways.</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">## Pathways: 2</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">##  Biggest pathway: 129 genes</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">##  h-index: 1 pathways with at least 1 genes.</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">## All genes in a single gene set.</a></code></pre></div>
<p>This provide us with some information we already knew, like the number of gnes and pathways but also the biggest pathway, and that all genes are in a single gene set.</p>
<p>As a <code>GeneSetCollection</code> is a collection of gene sets, we can see how many genes are for each gene sets. If the number of genes in all the gene sets is greater than the number of genes in the <code>GeneSetCollection</code> then there are some genes in several gene sets breaking the independence between gene sets.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">gpp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/genesPerPathway.html">genesPerPathway</a></span>(gss)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">gpp</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">##  chr5q23 chr16q24 </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">##       86      129</a></code></pre></div>
<p>Here genesPerPathways returns the number of genes each pathway have, thus adding them will summarize the total number of genes if they are not duplicated. If they are whe have the method <code>nGenes</code>, which return 215 genes in both pathways.</p>
<p>We can retrieve in how many pathways each gene is :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">ppg &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pathwaysPerGene.html">pathwaysPerGene</a></span>(gss)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">head</span>(ppg)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">##  ACTBP4 ADAMTS2  ADRA1B  AFG3L1 ANKRD11 ANKRD43 </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">##       1       1       1       1       1       1</a></code></pre></div>
<p>As expected all the genes <code>all(ppg == 1)</code> are in a single gene set. If genes would be repeated in several pathways we could use the <code>nPathways</code> method wich returns what we knew, that there are 2 pathways in total. We can also test if gene sets are independent from each other with <code><a href="../reference/independence.html">independence()</a></code>, in this case: TRUE.</p>
<p>We can also check if there are duplicated genes (genes that are exactly in the same pathways), and duplicated pathways (pathways with the same genes)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/duplicatedGenes.html">duplicatedGenes</a></span>(gss)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">## [1] TRUE</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="../reference/duplicatedPathways.html">duplicatedPathways</a></span>(gss)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">## [1] FALSE</a></code></pre></div>
<p>We can also see if some pathways are inside another pathway using <code>nested</code> method.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/nested.html">nested</a></span>(Info)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">##         1430728 156580 156582 194840 211859</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">## 1430728       1      1      1      0      1</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">## 156580        0      1      0      0      0</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">## 156582        1      1      1      0      1</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">## 194840        0      0      0      1      0</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">## 211859        1      1      1      0      1</a></code></pre></div>
<p>This would mean that pathway “1430728” is in the pathway “156580” and “156582” and “211859”.</p>
<p>We can also measure the information content and the probability to have such a pathways and genes with <code>gene</code> and <code>pathway</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/pathway.html">pathway</a></span>(gss)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">##          IC maxIC genes Prob_#_genes Prob_pathways_#_genes</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">## chr5q23   0     0    86          0.5                     1</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">## chr16q24  0     0   129          0.5                     1</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">head</span>(<span class="kw"><a href="../reference/gene.html">gene</a></span>(gss)) <span class="co"># To avoid a long table</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">##         IC maxIC pathways Prob_#_pathways Prob_genes_#_pathways</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">## ACTBP4   0     0        1               1                   0.5</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">## ADAMTS2  0     0        1               1                   0.5</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">## ADRA1B   0     0        1               1                   0.5</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">## AFG3L1   0     0        1               1                   0.5</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">## ANKRD11  0     0        1               1                   0.5</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">## ANKRD43  0     0        1               1                   0.5</a></code></pre></div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>## R version 3.5.0 (2017-01-27)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.5 LTS
## 
## Matrix products: default
## BLAS: /home/travis/R-bin/lib/R/lib/libRblas.so
## LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] GSEAdv_0.1.0         GSEABase_1.42.0      graph_1.58.0        
##  [4] annotate_1.58.0      XML_3.98-1.16        AnnotationDbi_1.42.1
##  [7] IRanges_2.14.11      S4Vectors_0.18.3     Biobase_2.40.0      
## [10] BiocGenerics_0.26.0  BiocStyle_2.8.2     
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.18       compiler_3.5.0     bitops_1.0-6      
##  [4] tools_3.5.0        digest_0.6.17      bit_1.1-14        
##  [7] evaluate_0.11      memoise_1.1.0      RSQLite_2.1.1     
## [10] rlang_0.2.2        DBI_1.0.0          commonmark_1.5    
## [13] yaml_2.2.0         pkgdown_1.1.0.9000 xfun_0.3          
## [16] stringr_1.3.1      roxygen2_6.1.0     xml2_1.2.0        
## [19] knitr_1.20         desc_1.2.0         fs_1.2.6          
## [22] rprojroot_1.3-2    bit64_0.9-7        R6_2.2.2          
## [25] rmarkdown_1.10     bookdown_0.7       blob_1.1.1        
## [28] magrittr_1.5       backports_1.1.2    htmltools_0.3.6   
## [31] MASS_7.3-50        assertthat_0.2.0   xtable_1.8-3      
## [34] stringi_1.2.4      RCurl_1.95-4.11    crayon_1.3.4</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preparation">Preparation</a></li>
      <li><a href="#session-info">Session info</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lluís Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
